<!doctype html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <base target="_blank" />
  <title>RegExp</title>
  <link rel="stylesheet" href="./css/default.css">
  <link rel="stylesheet" href="./css/base.css?v=3">
  <link rel="stylesheet" href="./css/app.css?v=3">
  <link rel="stylesheet" href="./css/scrollbar.css">
  <script src="./js/highlight.pack.js"></script>
  <script type="text/javascript">
  hljs.tabReplace = '  ';
  hljs.initHighlightingOnLoad();
  </script>
</head>
<body spellcheck="false" class="ppt">
  <section class="slide slide-cover">
    <h1>RegExp</h1>
    <h2 class="h3">redky@qq.com</h2>
  </section>
  <section class="slide">
    <div class="hd">
      <h1>学习目标</h1>
    </div>
    <div class="bd">
      <li>书写简单正则表达式
      <li>看懂正则表达式语法构成
    </div>
  </section>
  <section class="slide">
    <div class="hd">
      <h1>声明正则表达式</h1>
    </div>
    <div class="bd">
      <h2>初始化</h2>
      <ul>
        <li><code>var reg = new RegExp( string, pattern );</code>构造函数
        <li><code>var reg = /string/pattern;</code>直接量
      </ul>
      <h2>pattern</h2>
      <ul>
        <li>i: ignorecase 不区分大小写
        <li>g: global 匹配到字符串结束
        <li>m: multiline 多行
      </ul>
<pre class="codebox">
<code class="javascript" contenteditable="true">
var reg = /abc/i; // 匹配 'abc', 'Abc', 'aBc', 'abC', 'ABc', 'AbC', 'aBC', 'ABC'
var reg = new RegExp( '\\w', 'i' ); // 匹配不区分大小写字母, 数字和下划线
</code>
</pre>
    </div>
  </section>
  <section class="slide">
    <div class="hd">
      <h1>RegExp 测试</h1>
    </div>
    <div class="bd">
      <ul>
        <li><code>regexp.test( string );</code>返回 Boolean 值
        <li><code>regexp.exec( string );</code>返回数组, 元素为匹配字符和捕获结果(如果存在的话)
        <li><code>string.match( regexp );</code>返回数组, 两种情况:
          <ul>
            <li>regexp 为 global 模式, 元素为所有匹配到的字符串
            <li>其他, 元素为匹配到的字符串和捕获结果(如果存在的话)
          </ul>
      </ul>
<pre class="codebox">
<code class="javascript" contenteditable="true">
var reg = /abc/i;
var string = 'abcdefabc';
console.log( 'reg.test: ', reg.test(string) );
console.log( 'reg.exec: ', reg.exec(string) );
console.log( 'string.match: ', string.match(reg) );
</code>
<div class="runcase">Run</div>
</pre>
    </div>
  </section>
  <section class="slide">
    <div class="hd">
      <h1>RegExp 语法</h1>
    </div>
    <div class="bd">
      <ul>
        <li><code>/a/</code>匹配单个字符 'a'
        <li><code>/ab/</code>匹配两个字符 'ab'
      </ul>
      <h2>保留字符</h2>
      <ul>
        <li>/ 字符表示正则表达式的开始和结束. 如果需求本身是匹配 / 字符, 就需要对 / 字符进行转义, 即: <code>/\//</code>
        <li>\ 字符既然表示转义跟在它后面的字符, 那需求本身是匹配 \ 字符时, 就需要再对 \ 字符转义, 即: <code>/\\/</code>
      </ul>
    </div>   
  </section>
  <section class="slide">
    <div class="hd">
      <h1>RegExp 语法</h1>
    </div>
    <div class="bd">
      <ul>
        <li><code>/a|b/</code>匹配单个字符 'a' 或 'b'.
        <li><code>/ab|bc/</code>匹配两个字符 'ab' 或 'bc'
        <li><code>/z(ab|bc)/</code>匹配三个字符 'zab' 或 'zbc'
      </ul>
      <h2>保留字符</h2>
      <ul>
          <li>| - 关系或
            <ul>
              <li>两边作用范围: 遇到 ( 和 ) 结束; 没遇到时, 一直作用到正则表达式开头和结尾
            </ul>
          <li>() - 范围和分组
      </ul>
<pre class="codebox">
<code class="javascript" contenteditable="true">
var reg = /qq|baidu/;
console.log( 'qq', reg.exec('qq') );
console.log( 'baidu', reg.exec('baidu') );
console.log( 'baidu>qq?', reg.exec('baidu>qq?') );
</code>
<div class="runcase">Run</div>
</pre>
    </div>
  </section>
  <section class="slide">
    <div class="hd">
      <h1>RegExp 语法</h1>
    </div>
    <div class="bd">
      <ul>
        <li><code>/[ab]/</code>匹配单个字符 'a' 或 'b';
        <li><code>/[^ab]/</code>匹配除了 'a' 和 'b' 外的单个字符.
      </ul>
      <h2>保留字符</h2>
      <ul>
          <li>[] 匹配[]字符对里面的<mark>单个</mark>字符
            <ul>
              <li>a-z A-Z a-f
              <li>0-9 1-5
              <li>/[0-9A-Za-z]/  /[0-9a-z]/i
              <li>[]里面的特殊字符不再特殊
            </ul>
          <li>^ <mark>[] 字符对里面的 ^ 字符</mark>表示排除关系
      </ul>
<pre class="codebox">
<code class="javascript" contenteditable="true">
var reg = /[0-9a-zA-Z_]/;
console.log( reg );
console.log( 'google', reg.exec('google') );
console.log( '360', reg.exec('360') );
console.log( '_clearfix', reg.exec('_clearfix') );
reg = /[^0-9]/;
console.log( reg );
console.log( 'google', reg.exec('google') );
console.log( '360', reg.exec('360') );
console.log( '_clearfix', reg.exec('_clearfix') );
</code>
<div class="runcase">Run</div>
</pre>
    </div>  
  </section>
  <section class="slide">
    <div class="hd">
      <h1>RegExp 语法</h1>
    </div>
    <div class="bd">
      <ul>
        <li>. 匹配除换行符外的任意一个字符
      </ul>
      <h2>保留字符</h2>
      <ul>
          <li>.
      </ul>
      <mark>在不确定字符是否为特殊字符时, 可以在它前面添加转义字符 \.</mark>
<pre class="codebox">
<code class="javascript" contenteditable="true">
  var reg = /./;
  console.log( reg );
  console.log( 'Google', reg.exec('Google') );
  console.log( '.', reg.exec('.') );
  console.log( 'space', reg.exec(' ') );
  console.log( '\n\r', reg.exec('\n\r') );
  reg = /\./;
  console.log( reg );
  console.log( 'Google', reg.exec('Google') );
  console.log( '.', reg.exec('.') );
</code>
<div class="runcase">Run</div>
</pre>
    </div>     
  </section>
  <section class="slide">
    <div class="hd">
      <h1>RegExp 语法 - 分组/引用/捕获</h1>
    </div>
    <div class="bd">
      <ul>
        <li>() 分组
        <li>(a)\1 引用
        <li>(?:) 不捕获
      </ul>
<pre class="codebox">
<code class="javascript" contenteditable="true">
  // 取代码块中的字符串.
  var string = "var string ='I love Google! I\\'m too.';";
  var regexp = /(['"])(?:\\.|[^\\\n])*?\1/g;
  console.log( regexp.exec(string) );
  var ret = '';
  string.replace( regexp, function( match ) {
    ret = match.slice( 1, -1 );
  });
  alert( ret );
</code>
<div class="runcase">Run</div>
</pre>
<pre class="codebox">
<code class="javascript" contenteditable="true">
  var string = 'http://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=1&rsv_idx=1&tn=baidu&wd=redky&rsv_enter=1&rsv_sug3=5&rsv_sug4=128&rsv_sug1=4&rsv_sug2=0&inputT=1541';
  var regexp = /(?:[?&#])(.+?)=([^&#]*)/g;
  // console.log( string.match(regexp) );
  var map = {};
  string.replace( regexp, function( match, key, value ) {
    if ( map[key] ) {
      map[key] = typeof map[key] == 'string' ? [ map[key], value ] : map[key].push(value);
    } else {
      map[key] = value;
    }
  });
  console.log( map );
</code>
<div class="runcase">Run</div>
</pre>
    </div>    
  </section>
  <section class="slide">
    <div class="hd">
      <h1>RegExp 语法</h1>
    </div>
    <div class="bd">
      <ul>
        <li>\d 数字, 相当于 [0-9]
        <li>\D 非数字, 相当于 [^0-9]
        <li>\w 字符, 相当于 [a-zA-Z_]
        <li>\W 非字符, 相当于 [^a-zA-z_]
        <li>\s 空白字符
        <li>\S 非空白字符
        <li>\s\S 全部字符
      </ul>
    </div>
  </section>  
  <section class="slide">
    <div class="hd">
      <h1>RegExp 语法 - 修饰符</h1>
    </div>
    <div class="bd">
      <ul>
        <li>? 最多一个
        <li>+ 至少一个
        <li>* 任意个
        <li>?? +? *? 尽可能少的匹配
      </ul>
      <h2>保留字符</h2>
      <ul>
          <li>?
          <li>+
          <li>*
      </ul>
    </div>
  </section>
  <section class="slide">
    <div class="hd">
      <h1>RegExp 语法 - 修饰符</h1>
    </div>
    <div class="bd">
      <ul>
        <li>{3} 3个
        <li>{3, 10} 3到10个
        <li>{3,} 至少3个
      </ul>
      <h2>保留字符</h2>
      <ul>
          <li>{
          <li>}
      </ul>
    </div>
  </section>
  <section class="slide">
    <div class="hd">
      <h1>RegExp 语法 - 边界</h1>
    </div>
    <div class="bd">
      <ul>
        <li><code>/^a/</code>匹配以 a 开头的字符串
        <li><code>/b$/</code>匹配以 b 结束的字符串
        <li><code>/^ab$/</code>匹配 ab 字符串
      </ul>
      <h2>保留字符</h2>
      <ul>
        <li>^ 表示开头
        <li>$ 表示结尾
      </ul>
    </div>
  </section>
  <section class="slide">
    <div class="hd">
      <h1>RegExp 语法 - 边界</h1>
    </div>
    <div class="bd">
      <ul>
        <li>\b 单词边界
        <li>\B 非单词边界
      </ul>
      <h2>边界</h2>
      <ul>
        <li>开始或结束
        <li>换行或空格
        <li>标点符号
      </ul>
    </div>
  </section>
  <section class="slide">
    <div class="hd">
      <h1>RegExp 语法 - 边界</h1>
    </div>
    <div class="bd">
      <ul>
        <li>(?= ) 后面满足
        <li>(?!= ) 后面不满足
      </ul>
<pre class="codebox">
<code class="javascript" contenteditable="true">
  // 千分位格式化数字
  function format( number ) {
    var str = '' + number;
    if ( /^[1-9]\d*$/.test(str) ) {
      return str.replace( /\d(?=(?:\d{3})+$)/g, '$&,' );
    } else {
      alert( 'erorr' );
    }  
  }
  var ret = format( 1234567 );
  alert( ret );
</code>
<div class="runcase">Run</div>
</pre>
<pre class="codebox">
<code class="javascript" contenteditable="true">
  // 在数字和字符之间添加空格
  function insertSpace( string ) {
    string = '' + string;
    var reg = /\d(?=[a-z])|[a-z](?=\d)/gi;
    return string.replace( reg, '$& ' );
  }
  alert( insertSpace('1abc234de') );
</code>
<div class="runcase">Run</div>
</pre>
    </div>    
  </section>
  <section class="slide slide-cover">
    <h1>RegExp In JavaScript</h1>
  </section>
  <section class="slide">
    <div class="hd">
      <h1>RegExp</h1>
    </div>
    <div class="bd">
      <h2>prototype</h2>
      <ul>
        <li>regexp.ignoreCase
        <li>regexp.global
        <li>regexp.multiline
        <li>regexp.lastIndex
        <li>regexp.source
      </ul>
      <h2>method</h2>
      <ul>
        <li><code>regexp.exec( string );</code>return Array
        <li><code>regexp.test( string );</code>return Boolean
      </ul>
<pre class="codebox">
<code class="javascript" contenteditable="true">
// regexp.exec
var string = 'abc', 
    reg = /a/g;
console.log( reg.exec(string), reg.lastIndex ); // ["a"]
console.log( reg.exec(string) ); // null

// g 模式下会更新 reg.lastIndex 属性.
var string = 'abc', 
    reg = /a/g;
console.log( 'g:', reg.exec(string) ); // ["a"]
reg.lastIndex = 0;
console.log( 'g:', reg.exec(string) ); // ["a"]
</code>
<div class="runcase">Run</div>
</pre>
    </div> 
  </section>
  <section class="slide">
    <div class="hd">
      <h1>Others</h1>
    </div>
    <div class="bd">
      <ul>
        <li>string.split( delimiter[, limit] )
        <li>string.search( regexp )
        <li>string.match( regexp )
        <li>string.replace( regexp, ... )
      </ul>
    </div> 
  </section>
  <section class="slide">
    <div class="hd">
      <h1>String.prototype.split</h1>
    </div>
    <div class="bd">
      <ul>
        <li>delimiter - 匹配首/尾字符时, 在最前/最后添加空白字符.
        <li>正则包括捕获时, 把捕获的值做为元素放到结果数组中.
      </ul>
<pre class="codebox">
<code class="javascript" contenteditable="true">
  var string = 'ab';
  console.log( '匹配首字符: ', string.split('a') );   // [ '', 'b' ]
  console.log( '匹配尾字符: ', string.split('b') );   // [ 'a', '' ]

  console.log( '/(a)/', string.split(/(a)/) ); // [ '', 'a', 'b' ]
  console.log( '/(b)/', string.split(/(b)/) ); // [ 'a', 'b', '' ]
</code>
<div class="runcase">Run</div>
</pre>
    </div>     
  </section>    
  <section class="slide">
    <div class="hd">
      <h1>String.prototype.search</h1>
    </div>
    <div class="bd">
      <ul>
        <li>'string'.search( regexp ); // 参数不是 Regexp 时, 进行转换
        <li>return {Number}
      </ul>
<pre class="codebox">
<code class="javascript" contenteditable="true">
  console.log('ababcade'.search(/a(?=d)/) );  // 5
  console.log('abcabcadef'.search(/z/) );     // -1
</code>
<div class="runcase">Run</div>
</pre>
    </div>     
  </section>
  <section class="slide">
    <div class="hd">
      <h1>String.prototype.match</h1>
    </div>
    <div class="bd">
      <ul>
        <li>'string'.match( regexp );
        <li>return 不匹配时, 返回 null; 匹配时,
          <ul>
            <li>在 global 模式下, 返回所有匹配的值
            <li>其它, 返回首个匹配的值和捕获的结果(如果存在的话)
          </ul>
      </ul>
<pre class="codebox">
<code class="javascript" contenteditable="true">
  console.log( '/abc/', 'abcabd'.match(/abc/) );   //[ 'abc' ]
  console.log( '/(abc)/', 'abcabd'.match(/(abc)/) ); //[ 'abc', 'abc' ]
  console.log( '/(ab)/g', 'abcabdab'.match(/(ab)/g) );//['ab','ab', 'ab']
</code>
<div class="runcase">Run</div>
</pre>
    </div>     
  </section>
  <section class="slide">
    <div class="hd">
      <h1>String.prototype.replace</h1>
    </div>
    <div class="bd">
      <ul>
        <li>string.replace( string, string );
        <li>string.replace( regexp, string );
          <ul>
            <li>$& 匹配的字符串
            <li>$` 匹配到的字符之前的全部字符.
            <li>$' 匹配到的字符之后的全部字符.
            <li>$1, $2
            <li>$$
          </ul>
        <li>string.replace( regexp, function ); function 参数列表如下
          <ul>
            <li>match 匹配到的内容
            <li>$1 捕获的内容
            <li>$2 ...
            <li>index 匹配内容的索引
            <li>string 字符串本身
          </ul>
      </ul>
<pre class="codebox">
<code class="javascript" contenteditable="true">
  var string = 'I love Google!';
  alert( string.replace('Google', 'Sogou') );
  alert( string.replace(/google/i, '$& & Sogou') );
  string = string.replace( /L(o)ve/i, function( match, $1, index, string ) {
    console.log( 'match: ', match );
    console.log( '$1: ', $1 );
    console.log( 'index: ', index )
    console.log( 'string: ', string );
    return 'hate';
  });
  alert( string );
</code>
<div class="runcase">Run</div>
</pre>
    </div>     
  </section>
  <section class="slide">
    <div class="hd">
      <h1>应用</h1>
    </div>
    <div class="bd">
      <ul>
        <li>escapeHTML
      </ul>
    </div>
  </section>
  <section class="slide">
    <div class="hd">
      <h1>Links</h1>
    </div>
    <div class="bd">
      <ul>
        <li><a href="http://regex101.com/">http://regex101.com/</a>
        <li><a href="https://github.com/zhanhongtao/blog/issues/126">https://github.com/zhanhongtao/blog/issues/126</a>
        <li><a href="https://github.com/zhanhongtao/blog/issues/123">https://github.com/zhanhongtao/blog/issues/123</a>
      </ul>
    </div>
  </section>
  <section class="slide slide-cover">
    <blockquote style="margin-top: -100px; width: 75%;">Some people, when confronted with a problem, think "I know, I'll use regular expressions." ———— Now they have two problems.</blockquote>
  </section>  
  <section class="slide slide-cover">
    <h1>?</h1>
  </section>
  <nav id="navigator"></nav>
  <script src="./js/event.js"></script>
  <script src="./js/se.js?v=1"></script>
  <script src="./js/hash.js"></script>
  <script src="./js/runcase.js?v=1"></script>
  <script src="./js/ui.js"></script>
  <script src="./js/app.js"></script>
  <script src="./js/auto.slide.js"></script>
</body>
</html>
