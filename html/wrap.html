<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>wrap</title>
</head>
<body>
  <h1>测试 wrap</h1>
  <ul>
    <li>在函数之前做些事情</li>
    <li>在函数之后做些事情</li>
    <li>同时在函数之前/之后做些事情</li>
    <li>给原函数传递相同参数</li>
    <li>给原函数传递定制参数</li>
    <li>保留原函数的返回结果</li>
    <li>使用新函数返回结果</li>
  </ul>
  <div id="result"></div>
  <script src="../scripts/wrap.js"></script>
  <script>
    ;(function() {
      var result = document.getElementById( 'result' );
      var log = function( text ) {
        var p = document.createElement( 'p' );
        p.innerText = text;
        result.appendChild( p );
      };

      function sendRequest( args ) {
        log( '[同步]Send request....', args );
        return 'return 0';
      }

      var sendRequest1 = wrap( sendRequest, function( next ) {
        var result;
        log( 'before' );
        result = next();
        log( 'after' );
        return result;
      });

      var sendRequest2 = wrap( sendRequest, function( next ) {
        log( 'before' );
        next();
        log( 'after' );
        return 'return new result';
      });

      document.onclick = function() {
        var result = sendRequest1();
        log( result );
      };

      document.onclick = wrap( document.onclick, function( next ) {
        next();
        var result = sendRequest2();
        log( result );

        document.onclick = wrap( document.onclick, function() {});
      });


    })();
  </script>
</body>
</html>