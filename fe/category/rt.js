!function(t,e){if("object"==typeof exports&&exports)e(exports);else{var n={};e(n),"function"==typeof define&&define.amd?define(n):t.rt=n}}(this,function(t){"use strict";function e(t){this.string=t,this.tail=t,this.pos=0}function n(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(t){if(!o(t)||2!==t.length)throw new Error("Invalid tags: "+t);return[new RegExp(n(t[0])+"\\s*"),new RegExp("\\s*"+n(t[1]))]}function i(n,i){i=i||t.tags,n=n||"","string"==typeof i&&(i=i.split(f));for(var a,u,s,o,l=r(i),p=new e(n),v=[];!p.eos()&&(a=p.pos,s=p.scanUntil(l[0]),s&&(v.push(["text",s,a,a+s.length]),a+=s.length),p.scan(l[0]));){if(u=p.scan(d)||"name",p.scan(h),"@"===u?(s=p.scanUntil(g),p.scan(g),p.scanUntil(l[1])):s=p.scanUntil(l[1]),!p.scan(l[1]))throw new Error("Unclosed tag at "+p.pos);o=[u,s,a,p.pos],v.push(o),"@"===u&&(l=r(i=s.split(f)))}return c(v)}function a(t,e){return"(function() { "+i(t)+"}).call("+e+");"}function c(t){for(var e="var output = '', helper = this;",n=0,r=t.length;r>n;n++){var i=t[n];if(i){var c=i[1],u=/text|\^/;if(u.test(i[0])&&(c=c.replace(l,function(t){return"\\"+p[t]})),""!==c)switch(i[0]){case"name":e+="\n"+c+"\n";break;case">":e+="output += "+a(b.include(c),"helper")+";";break;case"=":e+="output += helper.escape("+c+");";break;case":=":e+="output += helper.unicode("+c+");";break;case"&":e+="output += "+c+";";break;case"text":e+="output += '"+c+"';"}}}return e+="return output;"}function u(t){return String(t).replace(/[&<>"'\/\\%]/g,function(t){return v[t]})}e.prototype.eos=function(){return""===this.tail},e.prototype.scan=function(t){var e=this.tail.match(t);if(e&&0===e.index){var n=e[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n}return""},e.prototype.scanUntil=function(t){var e,n=this.tail.search(t);switch(n){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=e.length,e};var s=Object.prototype.toString,o=Array.isArray||function(t){return"[object Array]"===s.call(t)},l=/\\|'|"|\r|\n|\u2028|\u2029/g,p={"'":"'",'"':'"',"\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},h=/\s*/,f=/\s+/,g=/\s*@/,d=/#|=|:=|&|@|>/;t.tags=["<%","%>"],t.cache={},t.debug=0;var v={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2f;","\\":"&#x5c;","%":"&#x0025;"};t.escapeHtml=u;var b={};t.helper=function(t,e){b[t]="function"==typeof e?e:function(){}},t.helper("escape",u),t.helper("include",function(e){var n,r="";try{n=document.getElementById(e),r=/input|textarea/i.test(n.nodeName)?n.value:n.innerHTML}catch(i){if(t.debug)throw i}return r}),t.helper("unicode",function(t){return String(t).replace(/['"\\]/g,function(t){var e=""+t.charCodeAt(0).toString(16);return"\\u"+new Array(5-e.length).join("0")+e})}),t.compile=function(e,n){var r=this.cache[n]||this.cache[e];if(r)return r;var a=i(e),c=function(){};try{c=new Function("it",a)}catch(u){if(t.debug)throw u}return this.cache[n?n:e]=function(t){return c.call(b,t)}},t.render=function(t,e,n){var r=this.compile(t,n);return r.call(b,e)},t.template=function(){return(arguments.length>1?t.render:t.compile).apply(t,arguments)}});